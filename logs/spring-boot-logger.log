2021-06-17 09:37:56,279 INFO org.springframework.boot.StartupInfoLogger [main] Starting NotificationApplication using Java 11.0.8 on DESKTOP-G3VGCPU with PID 16212 (C:\Users\Father\IdeaProjects\notification\target\classes started by Father in C:\Users\Father\IdeaProjects\notification)
2021-06-17 09:37:56,286 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.0, Spring v5.3.7
2021-06-17 09:37:56,286 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-06-17 09:37:57,835 INFO org.springframework.boot.StartupInfoLogger [main] Started NotificationApplication in 2.383 seconds (JVM running for 4.34)
2021-06-17 09:37:57,838 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2021-06-17 09:37:57,839 INFO com.severtrans.notification.NotificationApplication [main] Start...
2021-06-17 09:37:57,840 INFO com.severtrans.notification.service.Scheduler [main] log 2021-06-17 09:37:57.840
2021-06-17 09:37:57,841 INFO com.severtrans.notification.service.Scheduler [main] FTP
2021-06-17 09:37:58,649 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-06-17 09:37:58,870 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-06-17 09:37:59,731 INFO org.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLoggingListener [main] 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2021-06-17 09:37:59,778 ERROR org.springframework.boot.SpringApplication [main] Application run failed
java.lang.IllegalStateException: Failed to execute CommandLineRunner
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:779)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:344)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1336)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1325)
	at com.severtrans.notification.NotificationApplication.main(NotificationApplication.java:16)
Caused by: org.springframework.dao.DataIntegrityViolationException: PreparedStatementCallback; SQL []; Запрос не вернул результатов.; nested exception is org.postgresql.util.PSQLException: Запрос не вернул результатов.
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:104)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1541)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:667)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:713)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:738)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:794)
	at org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate.query(NamedParameterJdbcTemplate.java:209)
	at org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate.query(NamedParameterJdbcTemplate.java:221)
	at com.severtrans.notification.SendNotifications.send(SendNotifications.java:48)
	at com.severtrans.notification.SendNotifications$$FastClassBySpringCGLIB$$50303347.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.severtrans.notification.SendNotifications$$EnhancerBySpringCGLIB$$e8e7ab6b.send(<generated>)
	at com.severtrans.notification.service.Scheduler.putFile(Scheduler.java:84)
	at com.severtrans.notification.service.Scheduler.fixedDelaySch(Scheduler.java:60)
	at com.severtrans.notification.NotificationApplication.run(NotificationApplication.java:29)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:795)
	... 5 common frames omitted
Caused by: org.postgresql.util.PSQLException: Запрос не вернул результатов.
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:115)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:722)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:651)
	... 25 common frames omitted
2021-06-17 09:37:59,784 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2021-06-17 09:37:59,799 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2021-06-17 10:02:56,391 INFO org.springframework.boot.StartupInfoLogger [main] Starting NotificationApplication using Java 11.0.8 on DESKTOP-G3VGCPU with PID 21116 (C:\Users\Father\IdeaProjects\notification\target\classes started by Father in C:\Users\Father\IdeaProjects\notification)
2021-06-17 10:02:56,401 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.0, Spring v5.3.7
2021-06-17 10:02:56,402 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-06-17 10:02:57,431 INFO org.springframework.boot.StartupInfoLogger [main] Started NotificationApplication in 1.93 seconds (JVM running for 3.964)
2021-06-17 10:02:57,434 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2021-06-17 10:02:57,435 INFO com.severtrans.notification.NotificationApplication [main] Start...
2021-06-17 10:02:57,436 INFO com.severtrans.notification.service.Scheduler [main] log 2021-06-17 10:02:57.435
2021-06-17 10:02:57,436 INFO com.severtrans.notification.service.Scheduler [main] FTP
2021-06-17 10:02:58,236 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-06-17 10:02:58,430 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-06-17 10:02:59,272 INFO org.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLoggingListener [main] 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2021-06-17 10:02:59,300 ERROR org.springframework.boot.SpringApplication [main] Application run failed
java.lang.IllegalStateException: Failed to execute CommandLineRunner
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:779)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:344)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1336)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1325)
	at com.severtrans.notification.NotificationApplication.main(NotificationApplication.java:16)
Caused by: org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar [select * from notif where iddu='0']; nested exception is org.postgresql.util.PSQLException: ОШИБКА: столбец "iddu" не существует
  Подсказка: Возможно, предполагалась ссылка на столбец "notif.id_du".
  Позиция: 27
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:101)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1541)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:667)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:713)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:738)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:794)
	at org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate.query(NamedParameterJdbcTemplate.java:209)
	at org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate.query(NamedParameterJdbcTemplate.java:221)
	at com.severtrans.notification.SendNotifications.send(SendNotifications.java:49)
	at com.severtrans.notification.SendNotifications$$FastClassBySpringCGLIB$$50303347.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.severtrans.notification.SendNotifications$$EnhancerBySpringCGLIB$$ef062ad9.send(<generated>)
	at com.severtrans.notification.service.Scheduler.putFile(Scheduler.java:84)
	at com.severtrans.notification.service.Scheduler.fixedDelaySch(Scheduler.java:60)
	at com.severtrans.notification.NotificationApplication.run(NotificationApplication.java:29)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:795)
	... 5 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: столбец "iddu" не существует
  Подсказка: Возможно, предполагалась ссылка на столбец "notif.id_du".
  Позиция: 27
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2553)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2285)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:323)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:481)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:401)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:164)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:722)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:651)
	... 25 common frames omitted
2021-06-17 10:02:59,305 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2021-06-17 10:02:59,318 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2021-06-17 10:03:47,341 INFO org.springframework.boot.StartupInfoLogger [main] Starting NotificationApplication using Java 11.0.8 on DESKTOP-G3VGCPU with PID 16512 (C:\Users\Father\IdeaProjects\notification\target\classes started by Father in C:\Users\Father\IdeaProjects\notification)
2021-06-17 10:03:47,346 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.0, Spring v5.3.7
2021-06-17 10:03:47,346 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-06-17 10:03:48,412 INFO org.springframework.boot.StartupInfoLogger [main] Started NotificationApplication in 2.008 seconds (JVM running for 4.043)
2021-06-17 10:03:48,418 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2021-06-17 10:03:48,419 INFO com.severtrans.notification.NotificationApplication [main] Start...
2021-06-17 10:03:48,420 INFO com.severtrans.notification.service.Scheduler [main] log 2021-06-17 10:03:48.420
2021-06-17 10:03:48,420 INFO com.severtrans.notification.service.Scheduler [main] FTP
2021-06-17 10:03:49,300 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-06-17 10:03:49,500 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-06-17 10:03:50,496 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2021-06-17 10:13:19,421 INFO org.springframework.boot.StartupInfoLogger [main] Starting NotificationApplication using Java 11.0.8 on DESKTOP-G3VGCPU with PID 6916 (C:\Users\Father\IdeaProjects\notification\target\classes started by Father in C:\Users\Father\IdeaProjects\notification)
2021-06-17 10:13:19,425 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.0, Spring v5.3.7
2021-06-17 10:13:19,425 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-06-17 10:13:20,456 INFO org.springframework.boot.StartupInfoLogger [main] Started NotificationApplication in 2.014 seconds (JVM running for 4.023)
2021-06-17 10:13:20,458 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2021-06-17 10:13:20,459 INFO com.severtrans.notification.NotificationApplication [main] Start...
2021-06-17 10:13:20,460 INFO com.severtrans.notification.service.Scheduler [main] log 2021-06-17 10:13:20.460
2021-06-17 10:13:20,460 INFO com.severtrans.notification.service.Scheduler [main] FTP
2021-06-17 10:13:21,336 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-06-17 10:13:21,532 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-06-17 10:13:22,270 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
